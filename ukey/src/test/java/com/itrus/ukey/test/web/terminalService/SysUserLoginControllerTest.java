package com.itrus.ukey.test.web.terminalService;

import org.apache.commons.lang3.StringUtils;
import org.junit.Before;
import org.junit.Test;
import org.springframework.util.LinkedMultiValueMap;
import org.springframework.util.MultiValueMap;
import org.springframework.web.client.RestTemplate;

/**
 * Created by jackie on 2014/11/11.
 */
public class SysUserLoginControllerTest {
    private RestTemplate restTemplate;

    @Before
    public void initBean(){
        restTemplate = new RestTemplate();
    }

    @Test
    public void sysUseLoginTest(){
        String url = "http://127.0.0.1:8080/tsUserLogin/win";
//        url = "http://ukey-test.itrus.com.cn/itrusca/tsUserLogin/win";
        MultiValueMap<String, Object> map = new LinkedMultiValueMap<String, Object>();
        map.add("deviceSn","TW15031528000076");//设备序列号
//        map.add("plainText","Thu Nov 13 11:44:40 2014|18319526984049017");
//        map.add("signVal", "MIIFhgYJKoZIhvcNAQcCoIIFdzCCBXMCAQExCzAJBgUrDgMCGgUAMAsGCSqGSIb3DQEHAaCCBB0wggQZMIIDgqADAgECAhQi6w1U0mGRgxiYqUrtDhE6ZIcKaTANBgkqhkiG9w0BAQUFADByMTIwMAYDVQQDDCnlpKnlqIHor5rkv6Hov5DokKXniYjmtYvor5XnlKjmiLdDQeivgeS5pjEYMBYGA1UECwwP6L+Q6JCl54mI5rWL6K+VMRUwEwYDVQQKDAzlpKnlqIHor5rkv6ExCzAJBgNVBAYTAkNOMB4XDTE0MTExMzAzNDAzNloXDTE0MTEyMzAzNDAzNlowWDETMBEGA1UEAwwKdGVzdDEwMDAwMTERMA8GA1UECwwIUkEtQUHpg6gxFTATBgNVBAoMDOWkqeWogeivmuS/oTEXMBUGCSqGSIb3DQEJAQwIMUBxcS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJhOMWemcWnUx5lcMnAfVZv4NUaoc5JZaEoO+ROu1lremZ6/AFnceIv+hK8LFzTHj2p+IeU+X2hWh4v22PJ8SJX6qVAwOolrqkoW2gStPV4iD4SdDCki+HUTfkE8rX6voApwYnvVjg4mc1rTNz9+TJRBZFiBLSPr778YmIh77EwTAgMBAAGjggHEMIIBwDAJBgNVHRMEAjAAMAsGA1UdDwQEAwIGwDCBigYIKwYBBQUHAQEEfjB8MHoGCCsGAQUFBzAChm5odHRwOi8vWW91cl9TZXJ2ZXJfTmFtZTpQb3J0L1RvcENBL3VzZXJFbnJvbGwvY2FDZXJ0P2NlcnRTZXJpYWxOdW1iZXI9N0FGMTlDNjRGMUY1MjA1NTc0ODREQzQ0NDNENzc3RThEQ0JDRDA1RDBvBgNVHS4EaDBmMGSgYqBghl5odHRwOi8vWW91cl9TZXJ2ZXJfTmFtZTpQb3J0L1RvcENBL3B1YmxpYy9pdHJ1c2NybD9DQT03QUYxOUM2NEYxRjUyMDU1NzQ4NERDNDQ0M0Q3NzdFOERDQkNEMDVEMGgGA1UdHwRhMF8wXaBboFmGV2h0dHA6Ly8xMC4wLjAuNzA6ODA4MS9Ub3BDQS9wdWJsaWMvaXRydXNjcmw/Q0E9N0FGMTlDNjRGMUY1MjA1NTc0ODREQzQ0NDNENzc3RThEQ0JDRDA1RDAfBgNVHSMEGDAWgBRZau9CABu63kUz4wdyiQtsghYLrTAdBgNVHQ4EFgQUbnB6rAKfDiaQ/y1aAmvTm7i0hoowDQYJKoZIhvcNAQEFBQADgYEAO+Thz5hZ/4mhNsPRFVuUREGRF5weq0rQDUnlES0Y01hd/oLlBXuZMoYIVtl3BdmVnmkI0sV4uanMiN2eb5xXB4+oHkSGMyt0WiPOA/ZlkE7A8MyekL+qQuLKWn6KXUP7WTMWqu6F8lU2K7m5///d1PWS0unO7qZj1PtjoHmx+z0xggExMIIBLQIBATCBijByMTIwMAYDVQQDDCnlpKnlqIHor5rkv6Hov5DokKXniYjmtYvor5XnlKjmiLdDQeivgeS5pjEYMBYGA1UECwwP6L+Q6JCl54mI5rWL6K+VMRUwEwYDVQQKDAzlpKnlqIHor5rkv6ExCzAJBgNVBAYTAkNOAhQi6w1U0mGRgxiYqUrtDhE6ZIcKaTAJBgUrDgMCGgUAMA0GCSqGSIb3DQEBAQUABIGAcMP+W1YTEZcVnp+pLhprJRZqaqRH//V6O1KshKHpvuS1QSiz5ik8TTs3UTgb3INIxweENtBnbT21MwTvI/MJlfSN8WZOrW3Wa2bO3k8M6RO6BG5sLFSv02qEkPQ4HBWwP4R2GiPggX0SFb5TKSG66WfbzeLJtSiIfDIi9LsNUnQ=");
//        map.add("certSn","213AB114A756E54C3Cb07743FF12B50165063EA4");//证书序列号
//        map.add("certBase64","MIIECjCCA3OgAwIBAgIUITqxFKdW5Uw8sHdD/xK1AWUGPqQwDQYJKoZIhvcNAQEFBQAwcjEyMDAGA1UEAwwp5aSp5aiB6K+a5L+h6L+Q6JCl54mI5rWL6K+V55So5oi3Q0Hor4HkuaYxGDAWBgNVBAsMD+i/kOiQpeeJiOa1i+ivlTEVMBMGA1UECgwM5aSp5aiB6K+a5L+hMQswCQYDVQQGEwJDTjAeFw0xNDExMjAwNjU1NDNaFw0xNTExMjAwNjU1NDNaMEkxEzARBgNVBAMMCnRlc3QxNTExMjAxDjAMBgNVBAsMBVJB6YOoMRUwEwYDVQQKDAzlpKnlqIHor5rkv6ExCzAJBgNVBAYMAkNOMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCMWfELg1TV4A4Bhv1lxSQqK+NXv5TFENz2Th//VDCBdV3X/2+mJylHWKilG5T3DbRGIRNhma1J5GP9Z+IrEz1AR78cnDNK2lPsqlssiqOjC5MXnIHjYU1FV455X4Ng6oORZu2si3RBBQEZXZv8SkXKc09JrbZD+o4CX9jROmc6LQIDAQABo4IBxDCCAcAwCQYDVR0TBAIwADALBgNVHQ8EBAMCBsAwgYoGCCsGAQUFBwEBBH4wfDB6BggrBgEFBQcwAoZuaHR0cDovL1lvdXJfU2VydmVyX05hbWU6UG9ydC9Ub3BDQS91c2VyRW5yb2xsL2NhQ2VydD9jZXJ0U2VyaWFsTnVtYmVyPTdBRjE5QzY0RjFGNTIwNTU3NDg0REM0NDQzRDc3N0U4RENCQ0QwNUQwbwYDVR0uBGgwZjBkoGKgYIZeaHR0cDovL1lvdXJfU2VydmVyX05hbWU6UG9ydC9Ub3BDQS9wdWJsaWMvaXRydXNjcmw/Q0E9N0FGMTlDNjRGMUY1MjA1NTc0ODREQzQ0NDNENzc3RThEQ0JDRDA1RDBoBgNVHR8EYTBfMF2gW6BZhldodHRwOi8vMTAuMC4wLjcwOjgwODEvVG9wQ0EvcHVibGljL2l0cnVzY3JsP0NBPTdBRjE5QzY0RjFGNTIwNTU3NDg0REM0NDQzRDc3N0U4RENCQ0QwNUQwHwYDVR0jBBgwFoAUWWrvQgAbut5FM+MHcokLbIIWC60wHQYDVR0OBBYEFFuidTIVXK7ehr95hebQUraNXW6BMA0GCSqGSIb3DQEBBQUAA4GBAGXHJXuxdwsMqtpApD7U/ZH5hpZwNe5Puvxx0mM2Mv51fuKbAAiMsVVgyn/I3Q/mGeG47eguYpilVG4vIWZ6SIqXfSIfI9teyIqcJd0RCRDoj5f9TsXkgVmcheWdnIU8u3O5yIVb/II418eXlUZWtR+9u0XjLQ9xIho/X3iGkmGf");//证书的base64编码

        //吊销
        map.add("certSn","04E555BB1C27E91085CA4283C5D7731B65549542");//证书序列号
        map.add("certBase64","MIIEzjCCA7agAwIBAgIUBOVVuxwn6RCFykKDxddzG2VUlUIwDQYJKoZIhvcNAQEF\n" +
                "BQAwezELMAkGA1UEBhMCQ04xEzARBgNVBAoMCmlUcnVzQ2hpbmExHDAaBgNVBAsM\n" +
                "E0NoaW5hIFRydXN0IE5ldHdvcmsxOTA3BgNVBAMMMGlUcnVzQ2hpbmEgQ2xhc3Mg\n" +
                "MiBFbnRlcnByaXNlIFN1YnNjcmliZXIgQ0EgLSBHMzAeFw0xNTAzMzAwNTE4MjVa\n" +
                "Fw0yMDAzMjgwNTE4MjVaMIIBPDEuMCwGA1UEAwwl5L2Z5aea5biC5Zyw56iO5LiA\n" +
                "5YiG5bGA5rWL6K+V5oi3dGVzdDEdMBsGCSqGSIb3DQEJARYOY2FAbmJjYS5jb20u\n" +
                "Y24xCzAJBgNVBAYTAkNOMQ8wDQYDVQQHDAblroHms6IxDzANBgNVBAgMBua1meax\n" +
                "nzESMBAGA1UEAQwJTDQxNDk5NDAyMREwDwYDVQQUDAg4NzMwNDUwMDEPMA0GA1UE\n" +
                "CQwG5rW35puZMRIwEAYDVQQLDAkwMDAyLTAwMDIxFzAVBgNVBAsMDk5TUlVJRDpj\n" +
                "MTAwMDAwMR8wHQYDVQQLDBZERVBVSUQ6MzMwMjgxTDQxNDk5NDAyMTYwNAYDVQQK\n" +
                "DC3lpKnlqIHor5rkv6HmlbDlrZforqTor4HkuK3lv4PlroHms6LliIbkuK3lv4Mw\n" +
                "ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCledsDl5VKAr6F+TWYsTJZ\n" +
                "Dm6FY02nRoG+AIyTwkD4avJ6JLLTKX0Rjq2+zt5A2NlW7l2YretsOVRg/WRh+p8l\n" +
                "43a3EhseLhdsUrO8gk/CbUyunoT9Q9HiETCJ1TIgLwCjLs4O4QusI7mwr5mzBvi4\n" +
                "pc42JyrES+iv6dW4hFOexWujBFJ4IzY1jg1shAsr165qhLkf8uaO9W2fSHz0Y3GM\n" +
                "7vM+fTd2dyoF6jMrsXnftDmexo1eHFVC/oQFwhEQxq7y1VUKybKIJF3pPKQY+8RC\n" +
                "nwlWZShRrb1+qnndSrf9jIdmkIqeqU12YG0O0Ywf4CcP4yDscgYluELcuBrVLVyt\n" +
                "AgMBAAGjgYYwgYMwCQYDVR0TBAIwADAOBgNVHQ8BAf8EBAMCBLAwZgYDVR0fBF8w\n" +
                "XTBboFmgV4ZVaHR0cDovL3RvcGNhLml0cnVzLmNvbS5jbi9wdWJsaWMvaXRydXNj\n" +
                "cmw/Q0E9MkMxRDk3Mjg4REUxNEY4NUM2NjQwNjk4RkIyNDczOUFGNDdERkQxQTAN\n" +
                "BgkqhkiG9w0BAQUFAAOCAQEAQfpQ9aj0sWEyAkZ189SgQpUOnXI1gV3yb3HkX/Nf\n" +
                "WikeKReGRBsiTym5k6mZ2A83LcN1KEV5PfSiddZ7nu60Hth+lQhqwiNogfE+eORv\n" +
                "pQs4/JUzA79mfFsVS3MG38jg5nH0uBNKRtv75TFZcg9wTMxyu5gNHPakYPRk9uvp\n" +
                "tz1aaJK3GOXkw48Vo/PBXAyNSj+T6ze2jtfPbAnFAQofvDPPuvv1S6JSWQOnV1LY\n" +
                "xgECJ7HxP49jdZkYsUhzu6LQSB6YJcIAJB+SsOIBZxsrJkeCiF/BsrE4wgTf4q3W\n" +
                "QGlcyLYMCrjd/Pp4rItThj+WR2ITn+E5FbVML7f1GRfq6A==");
        //吊销
//        map.add("certSn","196250580dbc24c6f4d07912c0ca93128c46515a");//证书序列号
//        map.add("certBase64","MIIEMjCCA5ugAwIBAgIUGWJQWA28JMb00HkSwMqTEoxGUVowDQYJKoZIhvcNAQEFBQAwcjEyMDAGA1UEAwwp5aSp5aiB6K+a5L+h6L+Q6JCl54mI5rWL6K+V55So5oi3Q0Hor4HkuaYxGDAWBgNVBAsMD+i/kOiQpeeJiOa1i+ivlTEVMBMGA1UECgwM5aSp5aiB6K+a5L+hMQswCQYDVQQGEwJDTjAeFw0xNTAxMDQwOTQ3NDJaFw0xNTAyMDMwOTQ3NDJaMHExFjAUBgNVBAMMDXRlc3QxNTExMDQwMDIxETAPBgNVBAsMCFJBLUFB6YOoMRUwEwYDVQQKDAzlpKnlqIHor5rkv6ExCzAJBgNVBAYMAkNOMSAwHgYJKoZIhvcNAQkBDBF0ZXN0QGl0cnVzLmNvbS5jbjCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEArsOhqBmnXC8FBIKiCgiiuQwPCDyTEUiSMf4y+ziYfDhxgF88N1gCAhpOcyqYnwDlMy3tpAsEnclrllN3octKrk/M8stpxRG17AqmVu2mvhxo6nFhyfrHqZSkS11+8onq5X1h2iKndQeuIZrSXXZL0bc4PEG/AqmeQ3lRy/cBMLECAwEAAaOCAcQwggHAMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgbAMIGKBggrBgEFBQcBAQR+MHwwegYIKwYBBQUHMAKGbmh0dHA6Ly9Zb3VyX1NlcnZlcl9OYW1lOlBvcnQvVG9wQ0EvdXNlckVucm9sbC9jYUNlcnQ/Y2VydFNlcmlhbE51bWJlcj03QUYxOUM2NEYxRjUyMDU1NzQ4NERDNDQ0M0Q3NzdFOERDQkNEMDVEMG8GA1UdLgRoMGYwZKBioGCGXmh0dHA6Ly9Zb3VyX1NlcnZlcl9OYW1lOlBvcnQvVG9wQ0EvcHVibGljL2l0cnVzY3JsP0NBPTdBRjE5QzY0RjFGNTIwNTU3NDg0REM0NDQzRDc3N0U4RENCQ0QwNUQwaAYDVR0fBGEwXzBdoFugWYZXaHR0cDovLzEwLjAuMC43MDo4MDgxL1RvcENBL3B1YmxpYy9pdHJ1c2NybD9DQT03QUYxOUM2NEYxRjUyMDU1NzQ4NERDNDQ0M0Q3NzdFOERDQkNEMDVEMB8GA1UdIwQYMBaAFFlq70IAG7reRTPjB3KJC2yCFgutMB0GA1UdDgQWBBQibfmuEaZG6etOUvEGjf6VDgVa6zANBgkqhkiG9w0BAQUFAAOBgQBcI2rsQR13w5L5GsNKDo0c+dCYOss9UN6U63v58PzFqw7+xULCRCh7UKagkSwvwCvjWy0d1Nn3SN7sdryUkyo+18kXYi/+kSVM8wT3+B22DFrIyJEZWUr2nQDy+Pysm11RnNr5ora5GbTjTBUd9DmbPkRzvKHXdDIhpXhC1gMN/g==");
        map.add("needTrust",true);//查询是否有认证信息
        String reqStr = restTemplate.postForObject(url,map,String.class);
        System.out.println(reqStr);
    }

}
